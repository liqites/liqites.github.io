---
layout: post
title: Elasticsearch - Inverted Index
author: Tesla Lee
date: 2018-05-09 18:40:20 +0800
categories: [elasticsearch]
---

倒排索引 Inverted Index

<!--more-->

[维基词条](https://zh.wikipedia.org/wiki/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95)

倒排索引（英语：Inverted index），也常被称为`反向索引`、置`入档案`或`反向档案`，是一种索引方法，被用来存储在全文搜索下某个单词在`一个文档`或者`一组文档`中的`存储位置的映射`。它是文档检索系统中最常用的数据结构。

有两种不同的反向索引形式：

* 一条记录的水平反向索引（或者反向档案索引）包含每个引用单词的文档的列表。
* 一个单词的水平反向索引（或者完全反向索引）又包含每个单词在一个文档中的**位置**。

## 例子

以英文为例

> $T_0$ = "it is what it is
>
> $T_1$ = "waht is it"
>
> $T_2$ = "it is a banana"

就有以下反向文件索引：

```
"a":      {2}
"banana": {2}
"is":     {0, 1, 2}
"it":     {0, 1, 2}
"what":   {0, 1}
```
检索 "what", "is", "it" 时，可以得到对应的集合：
> $\\{ 0,1 \\} \cap \\{ 0, 1, 2 \\} \cap \\{ 0,1,2 \\} = \\{ 0,1 \\}$

同样的，我们还能建立一个完全反向索引

```
"a":      {(2, 2)}
"banana": {(2, 3)}
"is":     {(0, 1), (0, 4), (1, 1), (2, 1)}
"it":     {(0, 0), (0, 3), (1, 2), (2, 0)}
"what":   {(0, 2), (1, 0)}
```
对于 "what is it"

其完全索引就是{(1, 1), (1, 2), (1, 0)} 可以看到，只有在文档1 中，两个词是连续的。
